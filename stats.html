<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ - Driving Test Centre Stats</title>
    <link href="dtc.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/4.0.1/js/dataTables.fixedHeader.min.js"></script>

    <link href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.min.css"></link>
    <link href="https://cdn.datatables.net/fixedheader/4.0.1/css/fixedHeader.dataTables.min.css"></link>
</head>

<!-- Shouldn't be necessary, but otherwise the colors are broken in the navbar and the tables. Tried many fixes.-->
<style>
    .navbar-nav .nav-link.active {
        color: white;
    }
    .table>:not(caption)>*>* {
        background-color: transparent;
    }
</style>

<body data-bs-spy="scroll" data-bs-target="#navbar-example" data-bs-offset="0" tabindex="0">
    <nav id="navbar-example" class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Test Centre Stats - <span class="dtc-name fst-italic">@</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav nav-pills ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#overview">Overview</a></li>
                    <li class="nav-item"><a class="nav-link" href="#serious-faults">Serious and Dangerous Faults</a></li>
                    <li class="nav-item"><a class="nav-link" href="#driver-faults">Driver Faults</a></li>
                    <li class="nav-item"><a class="nav-link" href="#maneuvre-stats">Maneuvre Statistics</a></li>
                    <li class="nav-item"><a class="nav-link" href="#local-area-info">Local Area</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-5 pt-4">
        <section id="overview" class="pt-5">
            <h1 class="dtc-name display-5">@</h1>
            <p class="lead">The overall pass rate for <span class="dtc-name">@</span> is <span class="dtc-pass-rate">@</span>. The data below shows why people fail here.</p>
            <p>
                A <a href="about.html">Freedom of Information request</a> has revealed detailed statistics on the faults recorded for each driving test centre. This page shows which fault categories are most common at each test centre, and crucially, how these compare to the national average. Use this to help you practice for your test and learn what makes your test centre harder or easier than others.
            </p>
            <p>Pay extra attention to faults colored in <span class="text-danger fw-bold">red</span>, as they are found more frequently at <span class="dtc-name">@</span> than other test centres. Be thankful that faults colored in <span class="text-success fw-bold">green</span> are less common here.</p>
        </section>

        <!-- Serious and Dangerous Faults Section -->
        <section id="serious-faults" class="pt-5">
            <h2>Serious and Dangerous Faults</h2>
            <p>A serious or dangerous fault will result in a fail. A figure of 5% means that 5% of tests had a S/D fault recorded and therefore, 5% of people failed wholly or partially for this reason.</p>
            <div class="table-responsive">
                <table id="fail-faults-table" class="table"></table>
            </div>
        </section>

        <section id="driver-faults" class="pt-5">
            <h2>Driver Faults</h2>
            <p>Driver faults are minor mistakes. If a candidate accumulates too many in a single category, they will be replaced with a single serious fault. Accumulating 16 driver faults in total can also result in a fail. As you can get multiple driver faults in the same category,displayed below are absolute figures, not percentages. If <i>every</i> candidate got two driver faults for steering, this will show as 2.0.</p>
            <div class="table-responsive">
                <table id="minor-faults-table" class="table table-sm"></table>
            </div>
        </section>

        <section id="maneuvre-stats" class="pt-5">
            <h2>Maneuvre Statistics</h2>
            TODO reformat into a collapsable accordion and reword to avoid repetition...
            <p>Each driving test should include one of four reversing maneuvres. Ideally, a third of tests will also include an emergency stop (or controlled stop). The table below shows the frequency of each maneuvre - how often it is requested, regardless of it was completed successfully. Fail % says how often a serious or dangerous fault was awarded, whilst doing this maneuvre. Pass rate shows the overall pass rate for tests that included this maneuvre. From this, we can derive the relative difficulty of each maneuvre.

                Why is the frequency of each reversing maneuvres not 25% each?
                On the whole, it should be, because the consensus is that the maneuvre is picked randomly before the test begins. Sometimes examiner must deviate from this choice. If traffic is busy, the candidate might be late back or there may not have been enough time to perform this chosen maneuvre. However, it is almost always possible to do a reverse bay park by finishing at the test centre. The examiner may be forced to choose this maneuvre. Remember, the 'forward bay park' also requires the candidate to reverse out of the bay, and it is rarely done at the test centre itself. Sufficient road space may not be available en route for the parallel park and 'reverse right' maneuvres.

                Why does the sum of the reversing maneuvres' frequencies not add to 100%?
                Candidates who have already made a dangerous fault will often be asked to drive back to the test centre immediately and directly. If a reversing maneuvre was not completed by then, it will be skipped. Where no maneuvre has been recorded, the pass rate is 0%.

                Why does the overall pass rate not tally with the fault rate for each maneuvre?
                There are a number of hypotheses. The most likely is that harder maneuvres are systematically paired with easier test routes. Furthermore, it is established that a reverse bay park is more frequently requested when the test is running behind schedule. Experienced drivers are more likely to complete the test route with time to spare whilst others will drive slower. Candidates who were ultimately asked to do a reverse bay park are statistically more likely to have faults for undue hesitation and driving too slowly.

                Why is the emergency stop associated with higher pass rates?
                This is counterintuitive, because the emergency stop is just one additional task to do and it cannot wipe out faults previously accumulated. Further, whether it is meant to be included is supposedly decided randomly before the test begins. However the causation is flipped.
                * Most emergency stops are requested in the latter half of the test route. It can add 1-2 minutes to the test duration.
                * Candidates who have already made a dangerous fault will often be asked to drive back to the test centre immediately and directly, without additional reversing maneuvres or the emergency stop.
                * Candidates running late back due to traffic or being more hesitant won't be asked to do the emergency stop due to time. Such candidates are more likely to fail. Driving tests should not be seen as a race, but test duration is likely somewhat correlated with ability and pass rate.
                * Experienced drivers are more likely to complete the test route with time to spare whilst others will drive slower and not have time for the emergency stop.

            </p>
            <div class="table-responsive">
                <table data-sortable id="maneuvre-table" class="table sortable-theme-bootstrap">
                    <thead>
                    <tr>
                        <th>Maneuvre</th>
                        <th>Frequency</th>
                        <th>Local Fail %</th>
                        <th>National Fail %</th>
                        <th>Local Overall Pass Rate</th>
                        <th>National Overall Pass Rate</th>
                    </tr>
                    </thead>
                    <tbody id="maneuvre-table-body">
                    </tbody>
                </table>
            </div>
        </section>

        <section id="local-area-info" class="pt-5">
            <h2>Local Area Information</h2>

            <a id="google-maps-link" class="btn btn-primary" href="#" role="button" target="_blank">Google Maps</a>
            <a id="osm-link" class="btn btn-primary" href="#" role="button" target="_blank">OpenStreetMap</a>

            <a id="stop-signs-link" class="btn btn-primary" href="#" role="button" target="_blank">Stop Signs</a>
            
            <p>Use the buttons below to see a map of speed limits.</p>
            <div id="speed-limit-links" class="btn-group">
            </div>

        </section>
    </div>

    <script src="stats.js"></script>
</body>
</html>